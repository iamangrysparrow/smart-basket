# –î–û–ë–ê–í–õ–ï–ù–ò–ï: Smart Basket - –£–º–Ω–∞—è –∫–æ—Ä–∑–∏–Ω–∞

## –ö–æ–Ω—Ü–µ–ø—Ü–∏—è —Ñ–∏—à–∫–∏

**Smart Basket** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—É—é –∫–æ—Ä–∑–∏–Ω—É —Ç–æ–≤–∞—Ä–æ–≤ —É –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ:
1. –¢–µ–∫—É—â–∏—Ö –æ—Å—Ç–∞—Ç–∫–æ–≤ (Cache < Threshold)
2. –ê–∫—Ç—É–∞–ª—å–Ω—ã—Ö —Ü–µ–Ω –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ
3. –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ç–æ–≤–∞—Ä–æ–≤
4. –°—Ç–æ–∏–º–æ—Å—Ç–∏ –¥–æ—Å—Ç–∞–≤–∫–∏

### Workflow

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ ‚ö†Ô∏è ALERT: –ú–æ–ª–æ–∫–æ –∑–∞–∫–æ–Ω—á–∏—Ç—Å—è      ‚îÇ
‚îÇ          —á–µ—Ä–µ–∑ 2 –¥–Ω—è             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
             ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç:            ‚îÇ
‚îÇ "üõí –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –∫–æ—Ä–∑–∏–Ω—É"         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
             ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Smart Basket –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç:          ‚îÇ
‚îÇ - –ù—É–∂–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã                   ‚îÇ
‚îÇ - –¢–µ–∫—É—â–∏–µ –æ—Å—Ç–∞—Ç–∫–∏                 ‚îÇ
‚îÇ - –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ –∫–æ–ª-–≤–æ            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
             ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Price Checker –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç:          ‚îÇ
‚îÇ - –ö—É–ø–µ—Ä—Ç (–Ø–Ω–¥–µ–∫—Å.–ú–∞—Ä–∫–µ—Ç)         ‚îÇ
‚îÇ - –Ø–Ω–¥–µ–∫—Å.–õ–∞–≤–∫–∞                    ‚îÇ
‚îÇ - –î—Ä—É–≥–∏–µ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∏               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
             ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –†–µ–∑—É–ª—å—Ç–∞—Ç:                        ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ ‚îÇ üèÜ –õ–£–ß–®–ê–Ø –¶–ï–ù–ê: –ö—É–ø–µ—Ä—Ç    ‚îÇ   ‚îÇ
‚îÇ ‚îÇ –ú–æ–ª–æ–∫–æ 1–ª √ó 2 —à—Ç: 200‚ÇΩ    ‚îÇ   ‚îÇ
‚îÇ ‚îÇ –ú—è—Å–æ 1–∫–≥: 450‚ÇΩ            ‚îÇ   ‚îÇ
‚îÇ ‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ  ‚îÇ   ‚îÇ
‚îÇ ‚îÇ –ò–¢–û–ì–û: 650‚ÇΩ (—Å –¥–æ—Å—Ç–∞–≤–∫–æ–π) ‚îÇ   ‚îÇ
‚îÇ ‚îÇ                            ‚îÇ   ‚îÇ
‚îÇ ‚îÇ [üõí –û—Ç–∫—Ä—ã—Ç—å –≤ –ö—É–ø–µ—Ä—Ç]     ‚îÇ   ‚îÇ
‚îÇ ‚îÇ [üìã –°—Ä–∞–≤–Ω–∏—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è]  ‚îÇ   ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Smart Basket

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

```
Smart Basket Service
    ‚îÇ
    ‚îú‚îÄ‚Üí Basket Calculator
    ‚îÇ   ‚îî‚îÄ‚Üí –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –Ω—É–∂–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã –∏ –∫–æ–ª-–≤–æ
    ‚îÇ
    ‚îú‚îÄ‚Üí Price Checker Service
    ‚îÇ   ‚îú‚îÄ‚Üí –ö—É–ø–µ—Ä—Ç Parser
    ‚îÇ   ‚îú‚îÄ‚Üí –Ø–Ω–¥–µ–∫—Å.–õ–∞–≤–∫–∞ Parser
    ‚îÇ   ‚îî‚îÄ‚Üí [–î—Ä—É–≥–∏–µ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∏]
    ‚îÇ
    ‚îú‚îÄ‚Üí Availability Checker
    ‚îÇ   ‚îî‚îÄ‚Üí –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –≤ –∫–∞–∂–¥–æ–º –º–∞–≥–∞–∑–∏–Ω–µ
    ‚îÇ
    ‚îú‚îÄ‚Üí Cart Optimizer
    ‚îÇ   ‚îî‚îÄ‚Üí –í—ã–±—Ä–∞—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω—É—é –∫–æ–º–±–∏–Ω–∞—Ü–∏—é
    ‚îÇ       (–º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ + –¥–æ—Å—Ç–∞–≤–∫–∞ + —Å—Ä–æ–∫–∏)
    ‚îÇ
    ‚îî‚îÄ‚Üí Cart Manager
        ‚îú‚îÄ‚Üí –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—é
        ‚îú‚îÄ‚Üí –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É –≤ –∫–æ—Ä–∑–∏–Ω—É –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞
        ‚îî‚îÄ‚Üí –û—Ç—Å–ª–µ–¥–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞
```

---

## 1. Basket Calculator

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–∞–∫–∏–µ —Ç–æ–≤–∞—Ä—ã –∏ –≤ –∫–∞–∫–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –Ω—É–∂–Ω–æ –∑–∞–∫–∞–∑–∞—Ç—å

```python
def calculate_recommended_basket(user_id):
    """
    –†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—É—é –∫–æ—Ä–∑–∏–Ω—É —Ç–æ–≤–∞—Ä–æ–≤
    """
    basket = {
        'items': [],
        'total_items': 0,
        'estimated_total_price': 0,
        'reason': 'Stock below threshold'
    }
    
    # –®–∞–≥ 1: –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –ø—Ä–æ–¥—É–∫—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    products = db.products.filter(user_id=user_id)
    
    for product in products:
        # –®–∞–≥ 2: –†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Ç–µ–∫—É—â–∏–π Cache
        inventory = calculate_inventory(product.id)
        
        # –®–∞–≥ 3: –ï—Å–ª–∏ Cache < Threshold -> –¥–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É
        if inventory['cache'] < product.threshold:
            # –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ –∫–æ–ª-–≤–æ = –¥–æ –º–∞–∫—Å–∏–º—É–º–∞
            # –ù–∞–ø—Ä–∏–º–µ—Ä: –µ—Å–ª–∏ –ø–æ—Ä–æ–≥ 2–ª, –∞ –∫—ç—à 1–ª -> –∑–∞–∫–∞–∑–∞—Ç—å 3–ª
            recommended_qty = product.threshold * 1.5  # 150% –æ—Ç –ø–æ—Ä–æ–≥–∞
            shortage_qty = recommended_qty - inventory['cache']
            
            # –®–∞–≥ 4: –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–æ–≤–∞—Ä (–ø–æ–∑–∏—Ü–∏—é)
            best_item = select_best_item_variant(product.id)  # –ù–∞–ø—Ä–∏–º–µ—Ä, –ú–æ–ª–æ–∫–æ 3.2%
            
            basket['items'].append({
                'product_id': product.id,
                'product_name': product.name,
                'item_id': best_item.id,
                'item_name': best_item.name,  # "–ú–æ–ª–æ–∫–æ 3.2%"
                'quantity': shortage_qty,
                'unit': product.unit,
                'priority': 'URGENT' if inventory['cache'] < product.threshold * 0.5 else 'NORMAL',
                'current_stock': inventory['cache'],
                'threshold': product.threshold
            })
            
            basket['total_items'] += shortage_qty
    
    return basket

def select_best_item_variant(product_id):
    """
    –í—ã–±—Ä–∞—Ç—å –ª—É—á—à–∏–π –≤–∞—Ä–∏–∞–Ω—Ç —Ç–æ–≤–∞—Ä–∞ (Item) –∏–∑ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π
    –ö—Ä–∏—Ç–µ—Ä–∏–∏: –ª—É—á—à–∞—è —Ü–µ–Ω–∞/–∫–∞—á–µ—Å—Ç–≤–æ, –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å
    """
    items = db.items.filter(product_id=product_id)
    
    # –ï—Å–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–∑–∏—Ü–∏–π - –≤—ã–±—Ä–∞—Ç—å –ø–æ —Ä–µ–π—Ç–∏–Ω–≥—É/—Ü–µ–Ω–µ
    best_item = max(items, key=lambda x: x.rating or 0)
    return best_item
```

---

## 2. Price Checker Service

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å —Ü–µ–Ω—ã –Ω–∞ —Ç–æ–≤–∞—Ä—ã –≤ —Ä–∞–∑–Ω—ã—Ö –º–∞–≥–∞–∑–∏–Ω–∞—Ö

### 2.1 –ö—É–ø–µ—Ä—Ç Parser

```python
class KuperParser:
    """
    –ü–∞—Ä—Å–µ—Ä –∫–∞—Ç–∞–ª–æ–≥–∞ –ö—É–ø–µ—Ä—Ç (–Ø–Ω–¥–µ–∫—Å.–ú–∞—Ä–∫–µ—Ç)
    """
    
    def __init__(self):
        self.base_url = "https://kuperm.marketplace.yandex.ru"
        self.session = requests.Session()
    
    def search_product(self, product_name, category=None):
        """
        –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–∞ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é
        
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
        {
            'product_id': 'xyz123',
            'name': '–ú–æ–ª–æ–∫–æ 3.2% 1–ª',
            'price': 100,
            'old_price': 120,
            'discount': 17,
            'rating': 4.8,
            'reviews_count': 1250,
            'in_stock': True,
            'delivery_days': 1,
            'shop': '–ö—É–ø–µ—Ä—Ç',
            'url': 'https://...'
        }
        """
        
        try:
            # –®–∞–≥ 1: –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–∞ —á–µ—Ä–µ–∑ API –∏–ª–∏ –ø–∞—Ä—Å–∏–Ω–≥
            search_url = f"{self.base_url}/search"
            
            # –ü–æ–ø—ã—Ç–∫–∞ 1: API (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω)
            response = self._search_api(product_name, category)
            if response:
                return response
            
            # –ü–æ–ø—ã—Ç–∫–∞ 2: –°–∫—Ä–µ–π–ø–∏–Ω–≥ (–µ—Å–ª–∏ API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω)
            return self._search_scrape(product_name, category)
            
        except Exception as e:
            logger.error(f"Kuper search failed: {e}")
            return None
    
    def _search_api(self, product_name, category):
        """–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å API –ö—É–ø–µ—Ä—Ç–∞ (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω)"""
        # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: https://yandex.ru/dev/market/
        # –ï—Å–ª–∏ API –æ—Ç–∫—Ä—ã—Ç - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ
        pass
    
    def _search_scrape(self, product_name, category):
        """–ü–∞—Ä—Å–∏—Ç—å —á–µ—Ä–µ–∑ Selenium/BeautifulSoup"""
        try:
            # –ò—Å–ø–æ–ª—å–∑—É–µ–º BeautifulSoup –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞
            from bs4 import BeautifulSoup
            
            search_url = f"{self.base_url}/search?text={product_name}"
            response = self.session.get(search_url)
            soup = BeautifulSoup(response.content, 'html.parser')
            
            # –í—ã–¥–µ–ª–∏—Ç—å –ø–µ—Ä–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            product_card = soup.select_one('[data-test-id="product-card"]')
            
            if product_card:
                return {
                    'name': product_card.select_one('.product-name')?.text,
                    'price': int(product_card.select_one('.price')?.text.replace('‚ÇΩ', '').strip()),
                    'url': product_card.select_one('a')?.get('href'),
                    'in_stock': '–í –Ω–∞–ª–∏—á–∏–∏' in product_card.text,
                    'delivery_days': 1,
                    'shop': '–ö—É–ø–µ—Ä—Ç'
                }
        except Exception as e:
            logger.error(f"Kuper scrape failed: {e}")
        
        return None
    
    def get_product_details(self, product_id):
        """–ü–æ–ª—É—á–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ–≤–∞—Ä–µ"""
        pass
```

### 2.2 –Ø–Ω–¥–µ–∫—Å.–õ–∞–≤–∫–∞ Parser

```python
class YandexLavkaParser:
    """
    –ü–∞—Ä—Å–µ—Ä –Ø–Ω–¥–µ–∫—Å.–õ–∞–≤–∫–∞
    """
    
    def __init__(self):
        self.base_url = "https://lavka.yandex.ru"
        self.session = requests.Session()
    
    def search_product(self, product_name, delivery_zone=None):
        """
        –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–∞ –≤ –Ø–Ω–¥–µ–∫—Å.–õ–∞–≤–∫–µ
        
        delivery_zone: —à–∏—Ä–æ—Ç–∞/–¥–æ–ª–≥–æ—Ç–∞ –∏–ª–∏ –∞–¥—Ä–µ—Å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç–∞–≤–∫–∏
        """
        try:
            # –Ø–Ω–¥–µ–∫—Å.–õ–∞–≤–∫–∞ –∏–º–µ–µ—Ç –±–æ–ª–µ–µ –∑–∞–∫—Ä—ã—Ç—ã–π API
            # –û–ø—Ü–∏—è 1: GraphQL API (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ)
            return self._search_graphql(product_name)
            
        except Exception as e:
            logger.error(f"Yandex Lavka search failed: {e}")
            return None
    
    def _search_graphql(self, product_name):
        """–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å GraphQL API –õ–∞–≤–∫–∏"""
        # –ú–Ω–æ–≥–∏–µ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç GraphQL
        # –ú–æ–∂–Ω–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å reverse-engineer API
        pass
```

### 2.3 Price Cache

```python
class PriceCache:
    """
    –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–µ–Ω –¥–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
    """
    
    def __init__(self, ttl_minutes=60):
        self.ttl = ttl_minutes
        self.cache = {}
    
    def get_price(self, product_name, shop):
        """
        –ü–æ–ª—É—á–∏—Ç—å —Ü–µ–Ω—É —Å –∫—ç—à–µ–º
        """
        cache_key = f"{shop}:{product_name}"
        
        # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫—ç—à
        if cache_key in self.cache:
            cached_data, timestamp = self.cache[cache_key]
            if (datetime.now() - timestamp).minutes < self.ttl:
                return cached_data
        
        # –ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂—É—é —Ü–µ–Ω—É
        if shop == 'kuper':
            parser = KuperParser()
            data = parser.search_product(product_name)
        elif shop == 'lavka':
            parser = YandexLavkaParser()
            data = parser.search_product(product_name)
        else:
            return None
        
        # –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å
        if data:
            self.cache[cache_key] = (data, datetime.now())
        
        return data
    
    def clear_expired(self):
        """–û—á–∏—Å—Ç–∏—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –¥–∞–Ω–Ω—ã–µ"""
        now = datetime.now()
        expired = [
            k for k, (_, ts) in self.cache.items()
            if (now - ts).minutes > self.ttl
        ]
        for k in expired:
            del self.cache[k]
```

---

## 3. Availability Checker

```python
class AvailabilityChecker:
    """
    –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ –≤ —Ä–∞–∑–Ω—ã—Ö –º–∞–≥–∞–∑–∏–Ω–∞—Ö
    """
    
    def check_availability(self, basket_items):
        """
        –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –∫–∞–∂–¥–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ –≤ –∫–∞–∂–¥–æ–º –º–∞–≥–∞–∑–∏–Ω–µ
        
        –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
        [
            {'product_name': '–ú–æ–ª–æ–∫–æ 3.2%', 'quantity': 2},
            {'product_name': '–ú—è—Å–æ', 'quantity': 1}
        ]
        
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
        {
            'kuper': {
                'available': True,
                'items': [
                    {'product': '–ú–æ–ª–æ–∫–æ 3.2%', 'qty': 2, 'price': 100, 'total': 200},
                    {'product': '–ú—è—Å–æ', 'qty': 1, 'price': 450, 'total': 450}
                ],
                'subtotal': 650,
                'delivery': 0,
                'delivery_time': '–ó–∞–≤—Ç—Ä–∞ –∫ 10:00',
                'total': 650
            },
            'lavka': {
                'available': True,
                'items': [...],
                'subtotal': 680,
                'delivery': 50,
                'delivery_time': '–ß–µ—Ä–µ–∑ 30 –º–∏–Ω',
                'total': 730
            }
        }
        """
        
        results = {}
        shops = ['kuper', 'lavka']  # –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
        
        for shop in shops:
            results[shop] = self._check_shop(shop, basket_items)
        
        return results
    
    def _check_shop(self, shop, basket_items):
        """–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º –º–∞–≥–∞–∑–∏–Ω–µ"""
        
        shop_result = {
            'available': False,
            'items': [],
            'subtotal': 0,
            'delivery': 0,
            'delivery_time': None,
            'total': 0
        }
        
        all_available = True
        
        for item in basket_items:
            if shop == 'kuper':
                parser = KuperParser()
                product_data = parser.search_product(item['product_name'])
            elif shop == 'lavka':
                parser = YandexLavkaParser()
                product_data = parser.search_product(item['product_name'])
            else:
                product_data = None
            
            if product_data and product_data.get('in_stock'):
                shop_item = {
                    'product': item['product_name'],
                    'qty': item['quantity'],
                    'price': product_data['price'],
                    'total': product_data['price'] * item['quantity'],
                    'url': product_data.get('url')
                }
                shop_result['items'].append(shop_item)
                shop_result['subtotal'] += shop_item['total']
            else:
                all_available = False
                shop_result['items'].append({
                    'product': item['product_name'],
                    'qty': item['quantity'],
                    'status': 'NOT_AVAILABLE'
                })
        
        if all_available:
            # –î–æ–±–∞–≤–∏—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏
            shop_result['delivery'] = self._calculate_delivery(shop)
            shop_result['delivery_time'] = self._get_delivery_time(shop)
            shop_result['total'] = shop_result['subtotal'] + shop_result['delivery']
            shop_result['available'] = True
        
        return shop_result
    
    def _calculate_delivery(self, shop):
        """–†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏"""
        delivery_costs = {
            'kuper': 0,  # –ß–∞—Å—Ç–æ –±–µ—Å–ø–ª–∞—Ç–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ –ø—Ä–∏ –∑–∞–∫–∞–∑–µ > 500‚ÇΩ
            'lavka': 0   # –ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –ø—Ä–∏ > 300‚ÇΩ
        }
        return delivery_costs.get(shop, 100)
    
    def _get_delivery_time(self, shop):
        """–ü–æ–ª—É—á–∏—Ç—å –≤—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏"""
        delivery_times = {
            'kuper': '–ó–∞–≤—Ç—Ä–∞ –∫ 10:00',
            'lavka': '–ß–µ—Ä–µ–∑ 15-30 –º–∏–Ω'
        }
        return delivery_times.get(shop)
```

---

## 4. Cart Optimizer

```python
class CartOptimizer:
    """
    –í—ã–±—Ä–∞—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω—É—é –∫–æ–º–±–∏–Ω–∞—Ü–∏—é –º–∞–≥–∞–∑–∏–Ω–æ–≤
    """
    
    def optimize(self, availability_results):
        """
        –ù–∞–π—Ç–∏ –ª—É—á—à–∏–π –≤–∞—Ä–∏–∞–Ω—Ç –ø–æ —Ü–µ–Ω–µ/–¥–æ—Å—Ç–∞–≤–∫–µ/—Å—Ä–æ–∫–∞–º
        
        –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ç AvailabilityChecker
        
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
        {
            'winner_shop': 'kuper',
            'reason': 'Cheapest price',
            'savings': {'lavka': 80},  # –ù–∞ —Å–∫–æ–ª—å–∫–æ –¥–µ—à–µ–≤–ª–µ —á–µ–º —É –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤
            'recommended_items': [...],
            'total': 650
        }
        """
        
        valid_shops = {
            shop: data for shop, data in availability_results.items()
            if data.get('available')
        }
        
        if not valid_shops:
            return {
                'error': '–¢–æ–≤–∞—Ä—ã –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã –Ω–∏ –≤ –æ–¥–Ω–æ–º –º–∞–≥–∞–∑–∏–Ω–µ',
                'unavailable_shops': availability_results
            }
        
        # –°—Ç—Ä–∞—Ç–µ–≥–∏—è –≤—ã–±–æ—Ä–∞:
        # 1. –í—Å–µ —Ç–æ–≤–∞—Ä—ã –≤ –Ω–∞–ª–∏—á–∏–∏
        # 2. –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –æ–±—â–∞—è —Ü–µ–Ω–∞ (—Ç–æ–≤–∞—Ä + –¥–æ—Å—Ç–∞–≤–∫–∞)
        # 3. –ï—Å–ª–∏ —Ü–µ–Ω—ã –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ - –≤—ã–±—Ä–∞—Ç—å –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –¥–æ—Å—Ç–∞–≤–∫–∏
        
        best_shop = min(
            valid_shops.items(),
            key=lambda x: (
                x[1]['total'],  # –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫—Ä–∏—Ç–µ—Ä–∏–π - —Ü–µ–Ω–∞
                self._delivery_priority(x[1]['delivery_time'])  # –í—Ç–æ—Ä–∏—á–Ω—ã–π - –≤—Ä–µ–º—è
            )
        )
        
        winner_shop = best_shop[0]
        winner_data = best_shop[1]
        
        # –†–∞—Å—Å—á–∏—Ç–∞—Ç—å —ç–∫–æ–Ω–æ–º–∏—é
        savings = {
            shop: winner_data['total'] - data['total']
            for shop, data in valid_shops.items()
            if shop != winner_shop
        }
        
        return {
            'winner_shop': winner_shop,
            'reason': f'Best price: {winner_data["total"]}‚ÇΩ',
            'savings': savings,
            'recommended_items': winner_data['items'],
            'subtotal': winner_data['subtotal'],
            'delivery': winner_data['delivery'],
            'delivery_time': winner_data['delivery_time'],
            'total': winner_data['total'],
            'all_options': valid_shops
        }
    
    def _delivery_priority(self, delivery_time):
        """–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –¥–æ—Å—Ç–∞–≤–∫–∏ (–º–µ–Ω—å—à–µ = –ª—É—á—à–µ)"""
        priorities = {
            '–ß–µ—Ä–µ–∑ 15-30 –º–∏–Ω': 1,
            '–ó–∞–≤—Ç—Ä–∞ –∫ 10:00': 2,
            '–ß–µ—Ä–µ–∑ 1-2 –¥–Ω—è': 3
        }
        return priorities.get(delivery_time, 999)
```

---

## 5. Cart Manager

```python
class CartManager:
    """
    –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ—Ä–∑–∏–Ω–æ–π –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –º–∞–≥–∞–∑–∏–Ω–∞–º–∏
    """
    
    def create_cart(self, user_id, optimization_result):
        """
        –°–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å –æ –∫–æ—Ä–∑–∏–Ω–µ –≤ –ë–î
        """
        cart = db.shopping_carts.create({
            'user_id': user_id,
            'winner_shop': optimization_result['winner_shop'],
            'items': optimization_result['recommended_items'],
            'total': optimization_result['total'],
            'status': 'pending',  # pending, cart_opened, ordered, completed
            'created_at': datetime.now()
        })
        
        return cart
    
    def generate_cart_link(self, cart_id, shop):
        """
        –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ –∫–æ—Ä–∑–∏–Ω—É –≤ –º–∞–≥–∞–∑–∏–Ω–µ
        
        –î–ª—è –ö—É–ø–µ—Ä—Ç: –¥–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä—ã –≤ –∫–æ—Ä–∑–∏–Ω—É —á–µ—Ä–µ–∑ URL –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
        –î–ª—è –õ–∞–≤–∫–∏: —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –≤–≤–æ–¥–∞
        """
        
        cart = db.shopping_carts.get(cart_id)
        
        if shop == 'kuper':
            # –§–æ—Ä–º–∞—Ç: https://kuperm.marketplace.yandex.ru/...?cart=...
            # –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –ö—É–ø–µ—Ä—Ç –Ω–µ –∏–º–µ–µ—Ç –ø—É–±–ª–∏—á–Ω–æ–≥–æ API –¥–ª—è –∫–æ—Ä–∑–∏–Ω—ã
            # –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤
            return self._generate_manual_list(cart)
        
        elif shop == 'lavka':
            # –Ø–Ω–¥–µ–∫—Å.–õ–∞–≤–∫–∞ —Ç–æ–∂–µ –Ω–µ –∏–º–µ–µ—Ç –ø—Ä—è–º–æ–≥–æ API
            # –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
            return self._generate_manual_list(cart)
        
        else:
            return None
    
    def _generate_manual_list(self, cart):
        """
        –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤
        –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ—Ä–∑–∏–Ω—É
        """
        
        formatted_items = []
        for item in cart['items']:
            formatted_items.append(
                f"‚Ä¢ {item['product']} √ó {item['qty']} —à—Ç - {item['price']}‚ÇΩ = {item['total']}‚ÇΩ"
            )
        
        manual_list = "\n".join(formatted_items)
        
        # –ú–æ–∂–Ω–æ —Ç–∞–∫–∂–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å QR –∫–æ–¥ —Å–æ —Å–ø–∏—Å–∫–æ–º
        qr_code = self._generate_qr(manual_list)
        
        return {
            'type': 'manual_list',
            'manual_list': manual_list,
            'qr_code': qr_code,
            'total': cart['total'],
            'shop': cart['winner_shop']
        }
    
    def _generate_qr(self, data):
        """–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å QR –∫–æ–¥ —Å–æ —Å–ø–∏—Å–∫–æ–º —Ç–æ–≤–∞—Ä–æ–≤"""
        import qrcode
        qr = qrcode.QRCode()
        qr.add_data(data)
        qr.make()
        return qr.make_image()
    
    def update_cart_status(self, cart_id, status):
        """–û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∫–æ—Ä–∑–∏–Ω—ã"""
        db.shopping_carts.update(cart_id, {'status': status})
    
    def track_order(self, cart_id):
        """–û—Ç—Å–ª–µ–¥–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞ (–µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–∞–∑–º–µ—Å—Ç–∏–ª –∑–∞–∫–∞–∑)"""
        cart = db.shopping_carts.get(cart_id)
        
        # –ï—Å–ª–∏ –µ—Å—Ç—å order_id - –ø–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Å –ø–æ–º–æ—â—å—é –ø–∞—Ä—Å–µ—Ä–∞ –º–∞–≥–∞–∑–∏–Ω–∞
        if cart.get('order_id'):
            if cart['winner_shop'] == 'kuper':
                parser = KuperParser()
                order_status = parser.get_order_status(cart['order_id'])
            elif cart['winner_shop'] == 'lavka':
                parser = YandexLavkaParser()
                order_status = parser.get_order_status(cart['order_id'])
            
            return order_status
        
        return None
```

---

## 6. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö - –Ω–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã

```sql
-- –ö–æ—Ä–∑–∏–Ω—ã (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞–±–æ—Ä—ã —Ç–æ–≤–∞—Ä–æ–≤)
CREATE TABLE shopping_carts (
    id UUID PRIMARY KEY,
    user_id UUID NOT NULL,
    winner_shop VARCHAR(50) NOT NULL,     -- "kuper", "lavka"
    items JSON NOT NULL,                  -- –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ —Å —Ü–µ–Ω–∞–º–∏
    subtotal DECIMAL(10,2) NOT NULL,
    delivery DECIMAL(10,2),
    total DECIMAL(10,2) NOT NULL,
    status VARCHAR(50),                   -- "pending", "cart_opened", "ordered", "completed"
    order_id VARCHAR(255),                -- ID –∑–∞–∫–∞–∑–∞ –≤ –º–∞–≥–∞–∑–∏–Ω–µ (–µ—Å–ª–∏ –∑–∞–∫–∞–∑–∞–Ω–æ)
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);

-- –ò—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω (–¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –∏ —Ç—Ä–µ–Ω–¥–æ–≤)
CREATE TABLE price_history (
    id UUID PRIMARY KEY,
    item_id UUID NOT NULL REFERENCES items(id),
    shop VARCHAR(50) NOT NULL,
    price DECIMAL(10,2) NOT NULL,
    in_stock BOOLEAN,
    checked_at TIMESTAMP DEFAULT NOW()
);

-- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π (–∫–∞–∫—É—é —Ü–µ–Ω—É –≤–∏–¥–µ–ª–∏ –≤ –∫–∞–∫–æ–º –º–∞–≥–∞–∑–∏–Ω–µ)
CREATE TABLE price_comparison (
    id UUID PRIMARY KEY,
    product_id UUID NOT NULL REFERENCES products(id),
    kuper_price DECIMAL(10,2),
    kuper_in_stock BOOLEAN,
    lavka_price DECIMAL(10,2),
    lavka_in_stock BOOLEAN,
    [other_shops_prices] JSON,
    best_price DECIMAL(10,2),
    best_shop VARCHAR(50),
    checked_at TIMESTAMP DEFAULT NOW()
);
```

---

## 7. UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã Smart Basket

### 7.1 –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω—É–∂–Ω–æ–º –∑–∞–∫–∞–∑–µ

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  ‚ö†Ô∏è  –¢–†–ï–ë–£–ï–¢–°–Ø –ü–û–ü–û–õ–ù–ï–ù–ò–ï –û–°–¢–ê–¢–ö–û–í      ‚îÇ
‚îÇ                                         ‚îÇ
‚îÇ  –ú–æ–ª–æ–∫–æ        –ö—ç—à: 1.5–ª / –ü–æ—Ä–æ–≥: 2–ª   ‚îÇ
‚îÇ  –ú—è—Å–æ –Ω–∞ —Å—É–ø   –ö—ç—à: 0.3–∫–≥ / –ü–æ—Ä–æ–≥: 1–∫–≥ ‚îÇ
‚îÇ                                         ‚îÇ
‚îÇ  [üõí –°–æ—Å—Ç–∞–≤–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É]  [–ü–æ–∑–∂–µ]       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 7.2 –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –∫–æ—Ä–∑–∏–Ω—ã

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ          üõí –†–ï–ö–û–ú–ï–ù–î–£–ï–ú–ê–Ø –ö–û–†–ó–ò–ù–ê –¢–û–í–ê–†–û–í               ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                          ‚îÇ
‚îÇ  üèÜ –õ–£–ß–®–ê–Ø –¶–ï–ù–ê: –ö–£–ü–ï–†–¢                                ‚îÇ
‚îÇ     –≠–∫–æ–Ω–æ–º–∏—è vs –õ–∞–≤–∫–∞: -80‚ÇΩ                            ‚îÇ
‚îÇ     –î–æ—Å—Ç–∞–≤–∫–∞: –ó–∞–≤—Ç—Ä–∞ –∫ 10:00                           ‚îÇ
‚îÇ                                                          ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê        ‚îÇ
‚îÇ  ‚îÇ –¢–æ–≤–∞—Ä                  –ö–æ–ª-–≤–æ  –¶–µ–Ω–∞  –°—É–º–º–∞‚îÇ        ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§        ‚îÇ
‚îÇ  ‚îÇ –ú–æ–ª–æ–∫–æ 3.2% 1–ª           2—à—Ç  100‚ÇΩ  200‚ÇΩ ‚îÇ        ‚îÇ
‚îÇ  ‚îÇ –ú—è—Å–æ (–≥–æ–≤—è–¥–∏–Ω–∞)          1–∫–≥  450‚ÇΩ  450‚ÇΩ ‚îÇ        ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§        ‚îÇ
‚îÇ  ‚îÇ –°–£–ú–ú–ê –¢–û–í–ê–†–û–í:                      650‚ÇΩ  ‚îÇ        ‚îÇ
‚îÇ  ‚îÇ –î–û–°–¢–ê–í–ö–ê:                             0‚ÇΩ  ‚îÇ        ‚îÇ
‚îÇ  ‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ  ‚îÇ        ‚îÇ
‚îÇ  ‚îÇ –ò–¢–û–ì–û –ö –û–ü–õ–ê–¢–ï:                     650‚ÇΩ  ‚îÇ        ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò        ‚îÇ
‚îÇ                                                          ‚îÇ
‚îÇ  –î—Ä—É–≥–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã:                                       ‚îÇ
‚îÇ  –Ø–Ω–¥–µ–∫—Å.–õ–∞–≤–∫–∞: 730‚ÇΩ (–Ω–∞ 30 –º–∏–Ω —Ä–∞–Ω—å—à–µ)               ‚îÇ
‚îÇ                                                          ‚îÇ
‚îÇ  [üõí –û—Ç–∫—Ä—ã—Ç—å –≤ –ö—É–ø–µ—Ä—Ç] [üìã –°—Ä–∞–≤–Ω–∏—Ç—å] [‚Üª –ü–µ—Ä–µ—Å—á–µ—Ç]    ‚îÇ
‚îÇ                                                          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 7.3 –¢–∞–±–ª–∏—Ü–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ        üìä –°–†–ê–í–ù–ï–ù–ò–ï –¶–ï–ù–ê –ü–û –ú–ê–ì–ê–ó–ò–ù–ê–ú                  ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                        ‚îÇ
‚îÇ  –ö–£–ü–ï–†–¢          –Ø–ù–î–ï–ö–°.–õ–ê–í–ö–ê        –î–†–£–ì–ò–ï           ‚îÇ
‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ    ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ      ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ          ‚îÇ
‚îÇ  650‚ÇΩ ‚úì ‚òÖ        730‚ÇΩ ‚úì              N/A              ‚îÇ
‚îÇ  –î–æ—Å—Ç–∞–≤–∫–∞: 0‚ÇΩ    –î–æ—Å—Ç–∞–≤–∫–∞: 50‚ÇΩ      (–Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ)     ‚îÇ
‚îÇ  –ó–∞–≤—Ç—Ä–∞           30 –º–∏–Ω—É—Ç            -                ‚îÇ
‚îÇ                                                        ‚îÇ
‚îÇ  –¢–æ–≤–∞—Ä—ã:         –¢–æ–≤–∞—Ä—ã:              -                ‚îÇ
‚îÇ  ‚úì –ú–æ–ª–æ–∫–æ        ‚úì –ú–æ–ª–æ–∫–æ             -                ‚îÇ
‚îÇ  ‚úì –ú—è—Å–æ          ‚úì –ú—è—Å–æ               -                ‚îÇ
‚îÇ  ‚úì –ö–æ—Ñ–µ          ‚úó –ö–æ—Ñ–µ (–Ω–µ—Ç)        -                ‚îÇ
‚îÇ                                                        ‚îÇ
‚îÇ  [–í—ã–±—Ä–∞—Ç—å] [‚Üí] –í—ã–±—Ä–∞–Ω ‚úì              [–í—ã–±—Ä–∞—Ç—å]      ‚îÇ
‚îÇ                                                        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## 8. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Smart Basket —Å –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π

### Updated Flow –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ

```
[Alert] ‚Üí –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "–°–æ—Å—Ç–∞–≤–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É"
    ‚Üì
[Basket Calculator] ‚Üí –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –Ω—É–∂–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã
    ‚Üì
[Price Checker] ‚Üí –ó–∞–ø—Ä–æ—Å–∏—Ç—å —Ü–µ–Ω—ã –≤ –ö—É–ø–µ—Ä—Ç, –õ–∞–≤–∫–∞, –¥—Ä.
    ‚Üì
[Availability Checker] ‚Üí –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ
    ‚Üì
[Cart Optimizer] ‚Üí –í—ã–±—Ä–∞—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç
    ‚Üì
[UI] ‚Üí –ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—é —Å —Å—Å—ã–ª–∫–æ–π/—Å–ø–∏—Å–∫–æ–º
    ‚Üì
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –º–∞–≥–∞–∑–∏–Ω –∏ –∑–∞–∫–∞–∑—ã–≤–∞–µ—Ç
    ‚Üì
[Cart Manager] ‚Üí –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞
    ‚Üì
[Price History] ‚Üí –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å —Ü–µ–Ω—ã –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
```

---

## 9. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ fallback'–∏

| –°—Ü–µ–Ω–∞—Ä–∏–π | –†–µ—à–µ–Ω–∏–µ |
|----------|----------|
| API –º–∞–≥–∞–∑–∏–Ω–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞—Ä—Å–∏–Ω–≥ (BeautifulSoup) |
| –ü–∞—Ä—Å–∏–Ω–≥ —Å–ª–æ–º–∞–ª—Å—è | –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ä—É—á–Ω—É—é —Ñ–æ—Ä–º—É –¥–ª—è –≤–≤–æ–¥–∞ —Ü–µ–Ω |
| –¢–æ–≤–∞—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –≤–µ–∑–¥–µ | –ü–æ–∫–∞–∑–∞—Ç—å "–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –ø–æ–∑–∂–µ" + —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ |
| –¶–µ–Ω—ã —É—Å—Ç–∞—Ä–µ–ª–∏ (> 1 —á–∞—Å–∞) | –ó–∞–ø—Ä–æ—Å–∏—Ç—å —Å–≤–µ–∂–∏–µ —Ü–µ–Ω—ã |
| –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–∫–∞–∑–∞–ª —Å–∞–º | –û—Ç–º–µ—Ç–∏—Ç—å "manually_ordered" –≤ –ë–î |
| –ú–∞–≥–∞–∑–∏–Ω –∏–∑–º–µ–Ω–∏–ª —Å—Ç—Ä—É–∫—Ç—É—Ä—É | –ê–ª–µ—Ä—Ç –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ + –æ—Ç–∫–ª—é—á–∏—Ç—å –º–∞–≥–∞–∑–∏–Ω |

---

## 10. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```yaml
# config.yaml - –¥–æ–±–∞–≤–ª–µ–Ω–∏—è

price_checker:
  enabled: true
  price_cache_ttl_minutes: 60
  check_interval_minutes: 30  # –ü—Ä–æ–≤–µ—Ä—è—Ç—å —Ü–µ–Ω—ã –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω
  
  shops:
    kuper:
      enabled: true
      name: "–ö—É–ø–µ—Ä—Ç (–Ø–Ω–¥–µ–∫—Å.–ú–∞—Ä–∫–µ—Ç)"
      method: "scrape"  # –∏–ª–∏ "api" –µ—Å–ª–∏ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ
      base_url: "https://kuperm.marketplace.yandex.ru"
      delivery_time: "tomorrow_10am"
      free_delivery_threshold: 500
      
    lavka:
      enabled: true
      name: "–Ø–Ω–¥–µ–∫—Å.–õ–∞–≤–∫–∞"
      method: "scrape"
      base_url: "https://lavka.yandex.ru"
      delivery_time: "15-30min"
      free_delivery_threshold: 300
    
    # –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ê–ø—Ç–µ–∫—É, –°–∞–º–æ–≤—ã–≤–æ–∑ –∏ —Ç.–¥.
    # pharmacy:
    #   enabled: false
    #   name: "–ê–ø—Ç–µ–∫–∞ –ù–∏–∑–∫–∏—Ö –¶–µ–Ω"
    #   method: "api"

smart_basket:
  enabled: true
  auto_compose_on_alert: false  # –ù–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –∞ –ø–æ –∫–ª–∏–∫—É
  optimization_strategy: "price"  # "price", "delivery_time", "balanced"
  show_alternatives: true
  manual_list_format: "telegram"  # "telegram", "whatsapp", "email", "qr"
```

---

## 11. –í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è Smart Basket

### Phase 1: MVP (—Ç–µ–∫—É—â–µ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ)
- ‚úÖ –ü–æ–∏—Å–∫ –≤ –ö—É–ø–µ—Ä—Ç –∏ –õ–∞–≤–∫–∞
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –ª—É—á—à–µ–π —Ü–µ–Ω—ã
- ‚úÖ –†—É—á–Ω–æ–π —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è –∑–∞–∫–∞–∑–∞

### Phase 2: Integration
- API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (–µ—Å–ª–∏ –º–∞–≥–∞–∑–∏–Ω—ã –æ—Ç–∫—Ä–æ—é—Ç)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–∫–∞–∑ —á–µ—Ä–µ–∑ API
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞
- QR –∫–æ–¥—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ—Ä–∑–∏–Ω—É

### Phase 3: Analytics
- –ò—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω –Ω–∞ —Ç–æ–≤–∞—Ä—ã
- –ì—Ä–∞—Ñ–∏–∫–∏ –¥–∏–Ω–∞–º–∏–∫–∏ —Ü–µ–Ω
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ "–∑–∞–∫–∞–∑–∞—Ç—å –¥–µ—à–µ–≤–ª–µ"
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å–∫–∏–¥–∫–∞—Ö

### Phase 4: Advanced
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥–æ—Å—Ç–∞–≤–∫–∞–º–∏ (–Ø–Ω–¥–µ–∫—Å.–î–æ—Å—Ç–∞–≤–∫–∞, –°–î–≠–ö–∞)
- –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ –∏–∑ —Ä–∞–∑–Ω—ã—Ö –º–∞–≥–∞–∑–∏–Ω–æ–≤ (–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–æ—Å—Ç–∞–≤–∫–∏)
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –æ—Ñ—Ñ–ª–∞–π–Ω –º–∞–≥–∞–∑–∏–Ω–∞–º–∏
- –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å–∫–∏–¥–∫–∞—Ö

---

## 12. –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –¥–µ–º–æ

```python
# –ü—Ä–∏–º–µ—Ä –∫–æ—Ä–∑–∏–Ω—ã
demo_basket = {
    'items': [
        {'product_name': '–ú–æ–ª–æ–∫–æ 3.2%', 'quantity': 2},
        {'product_name': '–ú—è—Å–æ (–≥–æ–≤—è–¥–∏–Ω–∞)', 'quantity': 1},
        {'product_name': '–ö–æ—Ñ–µ Lavazza', 'quantity': 1}
    ]
}

# –ü—Ä–∏–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
demo_optimization = {
    'winner_shop': 'kuper',
    'reason': 'Cheapest price',
    'savings': {'lavka': 80},
    'recommended_items': [
        {'product': '–ú–æ–ª–æ–∫–æ 3.2%', 'qty': 2, 'price': 100, 'total': 200},
        {'product': '–ú—è—Å–æ', 'qty': 1, 'price': 450, 'total': 450},
        {'product': '–ö–æ—Ñ–µ', 'qty': 1, 'price': 200, 'total': 200}
    ],
    'subtotal': 850,
    'delivery': 0,
    'delivery_time': '–ó–∞–≤—Ç—Ä–∞ –∫ 10:00',
    'total': 850,
    'all_options': {
        'kuper': {'total': 850},
        'lavka': {'total': 930}
    }
}
```

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**Smart Basket** –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç —Å–∏—Å—Ç–µ–º—É –∏–∑ –ø—Ä–æ—Å—Ç–æ–≥–æ —Ç—Ä–µ–∫–µ—Ä–∞ –æ—Å—Ç–∞—Ç–∫–æ–≤ –≤ **—É–º–Ω–æ–≥–æ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è**, –∫–æ—Ç–æ—Ä—ã–π:

1. ‚úÖ –ó–Ω–∞–µ—Ç, –∫–∞–∫–∏–µ —Ç–æ–≤–∞—Ä—ã –Ω—É–∂–Ω–æ –∑–∞–∫–∞–∑–∞—Ç—å
2. ‚úÖ –ù–∞—Ö–æ–¥–∏—Ç –ª—É—á—à–∏–µ —Ü–µ–Ω—ã –≤ —Ä–∞–∑–Ω—ã—Ö –º–∞–≥–∞–∑–∏–Ω–∞—Ö
3. ‚úÖ –°–æ—Å—Ç–∞–≤–ª—è–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—É—é –∫–æ—Ä–∑–∏–Ω—É
4. ‚úÖ –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
5. ‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç —Ü–µ–Ω—ã –¥–ª—è –±—É–¥—É—â–∏—Ö –∑–∞–∫–∞–∑–æ–≤

–≠—Ç–æ —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ —É–ø—Ä–æ—â–∞–µ—Ç –∂–∏–∑–Ω—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç **—Ä–µ–∞–ª—å–Ω—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å** —Å–∏—Å—Ç–µ–º–µ!