Выбери лучший товар из результатов поиска в интернет-магазине.

## Что ищет пользователь
Название: {{DRAFT_ITEM_NAME}}
Требуемое количество: {{DRAFT_ITEM_QUANTITY}} {{DRAFT_ITEM_UNIT}}
{{DRAFT_ITEM_CATEGORY}}

{{PURCHASE_HISTORY}}

## Результаты поиска в магазине
{{SEARCH_RESULTS}}

## Твоя задача
1. ФИЛЬТРУЙ нерелевантные товары (паста томатная != томаты, кефир != молоко)
2. Выбери товар с лучшим соотношением цена/объём
3. Рассчитай количество упаковок для требуемого объёма
4. Предложи 2-3 альтернативы
5. Если ничего не подходит — selected_product_id = null

## Критерии выбора (в порядке приоритета)
1. **Соответствие запросу** — товар должен быть тем, что искал пользователь
2. **Наличие** — товар в наличии (InStock = true)
3. **Цена за объём** — минимальная стоимость для покрытия требуемого количества
4. **Фасовка** — близка к требуемому количеству (минимизируй излишек)

## Расчёт количества упаковок

### Пример 1: Весовой товар
Нужно: 1 кг томатов
Товар: Томаты красные, 77.40₽, фасовка 0.3 кг
- Расчёт: ceil(1 / 0.3) = 4 упаковки
- Получим: 1.2 кг
- Стоимость: 309.60₽
- quantity = 4

### Пример 2: Жидкости
Нужно: 2 л молока
Вариант A: Молоко 930мл (0.93л) за 89₽
- ceil(2 / 0.93) = 3 шт → 2.79л → 267₽

Вариант B: Молоко 1.5л за 129₽
- ceil(2 / 1.5) = 2 шт → 3л → 258₽

Выбираем B — дешевле за нужный объём.

### Пример 3: Штучный товар
Нужно: 2 шт лимона
Товар: Лимон, 25₽/шт
- quantity = 2

## Формат данных товара
```json
{
  "Id": "tomaty-krasnye-06257c5",
  "Name": "Томаты красные",
  "Price": 77.4,
  "Unit": "кг",
  "Quantity": 0.3,
  "InStock": true
}
```
Здесь Price = 77.40₽ за упаковку, Quantity = 0.3 кг в упаковке.

## ОТВЕТ

Верни ТОЛЬКО JSON (без markdown, без ```):
{
  "selected_product_id": "точный-id-из-результатов-или-null",
  "quantity": 1,
  "reasoning": "Краткое обоснование выбора",
  "alternatives": ["id-альтернативы-1", "id-альтернативы-2"]
}

## КРИТИЧЕСКИ ВАЖНО
- **selected_product_id** — ТОЧНЫЙ Id из результатов поиска (копируй как есть!)
- **quantity** — количество УПАКОВОК (целое число, не вес/объём!)
- **alternatives** — массив Id альтернативных товаров (2-3 шт)
- Если фасовка не указана (Quantity = 0) — quantity = требуемое количество
- Верни ТОЛЬКО JSON, никакого другого текста!
