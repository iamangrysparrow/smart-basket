namespace SmartBasket.Core.Helpers;

/// <summary>
/// Эмодзи по названию товара из магазина.
/// Нечёткий поиск по ключевым словам (корням слов).
/// Порядок ключевых слов важен — более специфичные первыми.
/// </summary>
public static class ProductEmoji
{
    // Порядок важен! Специфичные ключевые слова — первыми
    private static readonly (string Keyword, string Emoji)[] Keywords =
    {
        // ═══ Молочка ═══
        ("сыр", "🧀"),
        ("творог", "🧀"),
        ("йогурт", "🥛"),
        ("кефир", "🥛"),
        ("ряженк", "🥛"),
        ("сметан", "🥛"),
        ("сливки", "🥛"),
        ("молок", "🥛"),
        ("масло сливочн", "🧈"),
        ("маргарин", "🧈"),
        ("яйц", "🥚"),
        ("мороженое", "🍦"),
        ("пломбир", "🍦"),

        // ═══ Мясо ═══
        ("курин", "🍗"),
        ("куриц", "🍗"),
        ("курица", "🍗"),
        ("цыпл", "🍗"),
        ("индейк", "🍗"),
        ("утка", "🍗"),
        ("говядин", "🥩"),
        ("свинин", "🥩"),
        ("баранин", "🥩"),
        ("телятин", "🥩"),
        ("фарш", "🥩"),
        ("стейк", "🥩"),
        ("мясо", "🥩"),
        ("шашлык", "🍖"),
        ("рёбр", "🍖"),
        ("ребр", "🍖"),

        // ═══ Колбасы ═══
        ("сосиск", "🌭"),
        ("сардельк", "🌭"),
        ("колбас", "🌭"),
        ("ветчин", "🥓"),
        ("бекон", "🥓"),
        ("грудинк", "🥓"),
        ("паштет", "🥫"),

        // ═══ Рыба ═══
        ("лосось", "🐟"),
        ("сёмга", "🐟"),
        ("семга", "🐟"),
        ("форель", "🐟"),
        ("треска", "🐟"),
        ("минтай", "🐟"),
        ("горбуш", "🐟"),
        ("скумбри", "🐟"),
        ("сельд", "🐟"),
        ("рыб", "🐟"),
        ("креветк", "🦐"),
        ("кальмар", "🦑"),
        ("краб", "🦀"),
        ("икра", "🍣"),

        // ═══ Овощи ═══
        ("картофель", "🥔"),
        ("картошк", "🥔"),
        ("морков", "🥕"),
        ("помидор", "🍅"),
        ("томат", "🍅"),
        ("огурц", "🥒"),
        ("капуст", "🥬"),
        ("брокколи", "🥦"),
        ("кабачок", "🥒"),
        ("баклажан", "🍆"),
        ("салат", "🥬"),
        ("зелень", "🥬"),
        ("укроп", "🌿"),
        ("петрушк", "🌿"),
        ("лук", "🧅"),
        ("чеснок", "🧄"),
        ("перец", "🌶️"),
        ("свёкл", "🥕"),
        ("свекл", "🥕"),
        ("тыкв", "🎃"),
        ("овощ", "🥕"),

        // ═══ Фрукты ═══
        ("яблок", "🍎"),
        ("банан", "🍌"),
        ("апельсин", "🍊"),
        ("мандарин", "🍊"),
        ("лимон", "🍋"),
        ("виноград", "🍇"),
        ("груш", "🍐"),
        ("персик", "🍑"),
        ("абрикос", "🍑"),
        ("слив", "🍑"),
        ("черешн", "🍒"),
        ("вишн", "🍒"),
        ("клубник", "🍓"),
        ("малин", "🍓"),
        ("ягод", "🍓"),
        ("арбуз", "🍉"),
        ("дын", "🍈"),
        ("ананас", "🍍"),
        ("киви", "🥝"),
        ("манго", "🥭"),
        ("авокадо", "🥑"),
        ("фрукт", "🍎"),

        // ═══ Грибы, орехи ═══
        ("шампиньон", "🍄"),
        ("гриб", "🍄"),
        ("орех", "🥜"),
        ("миндаль", "🥜"),
        ("фундук", "🥜"),
        ("кешью", "🥜"),
        ("фисташк", "🥜"),
        ("арахис", "🥜"),
        ("семечк", "🌻"),
        ("изюм", "🍇"),
        ("курага", "🍇"),
        ("чернослив", "🍇"),

        // ═══ Хлеб, выпечка ═══
        ("хлеб", "🍞"),
        ("батон", "🍞"),
        ("багет", "🥖"),
        ("лаваш", "🍞"),
        ("булк", "🍞"),
        ("круассан", "🥐"),
        ("пирог", "🥧"),
        ("пирожок", "🥧"),
        ("слойк", "🥐"),
        ("выпечк", "🥐"),
        ("печень", "🍪"),
        ("пряник", "🍪"),
        ("вафл", "🧇"),
        ("сушк", "🥨"),
        ("сухар", "🥨"),
        ("хлебц", "🥖"),

        // ═══ Крупы, макароны ═══
        ("макарон", "🍝"),
        ("спагетти", "🍝"),
        ("паста", "🍝"),
        ("лапша", "🍜"),
        ("рис", "🍚"),
        ("греч", "🌾"),
        ("овсян", "🥣"),
        ("геркулес", "🥣"),
        ("крупа", "🌾"),
        ("каша", "🥣"),
        ("мюсли", "🥣"),
        ("хлопья", "🥣"),
        ("мука", "🌾"),

        // ═══ Напитки ═══
        ("сок", "🧃"),
        ("нектар", "🧃"),
        ("морс", "🍹"),
        ("компот", "🍹"),
        ("вода", "💧"),
        ("газировк", "🥤"),
        ("кола", "🥤"),
        ("лимонад", "🥤"),
        ("энергетик", "⚡"),
        ("квас", "🍺"),

        // ═══ Чай, кофе ═══
        ("кофе", "☕"),
        ("капучино", "☕"),
        ("эспрессо", "☕"),
        ("латте", "☕"),
        ("чай", "🍵"),
        ("какао", "☕"),

        // ═══ Сладости ═══
        ("шоколад", "🍫"),
        ("конфет", "🍬"),
        ("карамель", "🍬"),
        ("леденец", "🍭"),
        ("торт", "🎂"),
        ("пирожн", "🧁"),
        ("кекс", "🧁"),
        ("мармелад", "🍡"),
        ("зефир", "🍡"),
        ("халв", "🍡"),
        ("мёд", "🍯"),
        ("мед", "🍯"),
        ("варень", "🍓"),
        ("джем", "🍓"),
        ("сгущён", "🥛"),
        ("сгущен", "🥛"),

        // ═══ Соусы, масла ═══
        ("масло подсолн", "🌻"),
        ("масло оливк", "🫒"),
        ("масло растит", "🌻"),
        ("оливков", "🫒"),
        ("кетчуп", "🍅"),
        ("томатн паст", "🍅"),
        ("соус", "🥫"),
        ("майонез", "🥫"),
        ("горчиц", "🌶️"),
        ("специ", "🌶️"),
        ("приправ", "🌶️"),
        ("соль", "🧂"),
        ("сахар", "🧂"),

        // ═══ Консервы ═══
        ("консерв", "🥫"),
        ("тушёнк", "🥫"),
        ("тушенк", "🥫"),
        ("горошек", "🥫"),
        ("кукуруз", "🌽"),
        ("фасоль", "🥫"),
        ("оливк", "🫒"),
        ("маслин", "🫒"),

        // ═══ Снеки ═══
        ("чипс", "🍟"),
        ("попкорн", "🍿"),
        ("крекер", "🥨"),
        ("снек", "🍿"),

        // ═══ Готовая еда ═══
        ("пельмен", "🥟"),
        ("вареник", "🥟"),
        ("хинкал", "🥟"),
        ("манты", "🥟"),
        ("пицц", "🍕"),
        ("суши", "🍣"),
        ("ролл", "🍣"),
        ("сэндвич", "🥪"),
        ("бургер", "🍔"),
        ("блин", "🥞"),
        ("оладь", "🥞"),
        ("сырник", "🥞"),

        // ═══ Заморозка ═══
        ("заморож", "🧊"),
        ("замороз", "🧊"),

        // ═══ Детское ═══
        ("детск", "👶"),
        ("малыш", "👶"),
        ("подгузник", "👶"),
        ("памперс", "👶"),

        // ═══ Животные ═══
        ("кошк", "🐱"),
        ("кошач", "🐱"),
        ("котов", "🐱"),
        ("собак", "🐶"),
        ("собач", "🐶"),
        ("корм", "🐾"),
        ("наполнител", "🐾"),

        // ═══ Бытовая химия ═══
        ("стирк", "👕"),
        ("порошок", "👕"),
        ("моющ", "🧴"),
        ("чистящ", "🧴"),
        ("мыло", "🧼"),
        ("шампун", "🧴"),
        ("гель для душ", "🚿"),
        ("зубн паст", "🦷"),
        ("зубная", "🦷"),
        ("щётк", "🪥"),
        ("щетк", "🪥"),
        ("туалетн бумаг", "🧻"),
        ("салфетк", "🧻"),
        ("губк", "🧽"),
    };

    public const string Default = "📦";

    public static string Get(string? productName)
    {
        if (string.IsNullOrEmpty(productName))
            return Default;

        var lower = productName.ToLowerInvariant();

        foreach (var (keyword, emoji) in Keywords)
        {
            if (lower.Contains(keyword))
                return emoji;
        }

        return Default;
    }
}
