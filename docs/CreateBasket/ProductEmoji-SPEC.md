# Product Emoji — Спецификация

> Система эмодзи для визуального обозначения категорий и товаров
> Дата: Декабрь 2024

---

## Назначение

Визуальная идентификация товаров в UI без загрузки картинок из магазинов.

**Применение:**
- Карточки выбранных товаров в Workflow Timeline
- Список покупок (правая панель)
- Placeholder пока грузится картинка из магазина

---

## Два класса

| Класс | Источник данных | Стратегия поиска |
|-------|-----------------|------------------|
| `CategoryEmoji` | Наш справочник категорий | Точное совпадение по названию |
| `ProductEmoji` | Название товара из магазина | Нечёткий поиск по ключевым словам |

---

## 1. CategoryEmoji

Для наших категорий из справочника (DraftItem.Category).

```csharp
public static class CategoryEmoji
{
    private static readonly Dictionary<string, string> Map = 
        new(StringComparer.OrdinalIgnoreCase)
    {
        // ═══ Корневые категории ═══
        ["Овощи, фрукты, зелень, орехи"] = "🥬",
        ["Молоко, сыр, яйца, растительные продукты"] = "🥛",
        ["Мясо, птица"] = "🥩",
        ["Колбасы, сосиски, деликатесы"] = "🌭",
        ["Рыба, икра, дары моря"] = "🐟",
        ["Заморозка"] = "🧊",
        ["Макароны, крупы, мука"] = "🍝",
        ["Хлеб, хлебцы, выпечка"] = "🍞",
        ["Готовая еда"] = "🍱",
        ["Вода, соки, напитки"] = "🥤",
        ["Сладости"] = "🍬",
        ["Чай, кофе"] = "☕",
        ["Масло, соусы, специи"] = "🫒",
        ["Чипсы, снеки, сухофрукты"] = "🍿",
        ["Консервы, соленья, варенье"] = "🥫",
        ["Здоровый выбор"] = "💚",
        ["Бытовая химия, уборка"] = "🧹",
        ["Косметика, гигиена"] = "💄",
        ["Товары для животных"] = "🐾",
        ["Детские товары"] = "👶",
        ["Дом, кухня"] = "🏠",
        ["Дача, сад"] = "🌱",
        ["Одежда, обувь, аксессуары"] = "👕",
        ["Канцелярия, творчество, журналы"] = "📝",
        
        // ═══ Подкатегории (2-й уровень) ═══
        ["Овощи"] = "🥕",
        ["Фрукты, ягоды"] = "🍎",
        ["Зелень, салаты"] = "🥬",
        ["Грибы"] = "🍄",
        ["Орехи, сухофрукты, семечки"] = "🥜",
        ["Молоко"] = "🥛",
        ["Сыры"] = "🧀",
        ["Сметана, сливки"] = "🥛",
        ["Масло сливочное, маргарин"] = "🧈",
        ["Творог, творожки"] = "🧀",
        ["Йогурты"] = "🥛",
        ["Яйца"] = "🥚",
        ["Мороженое"] = "🍦",
        ["Птица"] = "🍗",
        ["Мясо"] = "🥩",
        ["Фарш, полуфабрикаты"] = "🥩",
        ["Пельмени, манты"] = "🥟",
        ["Колбасы"] = "🌭",
        ["Сосиски, сардельки"] = "🌭",
        ["Деликатесы, ветчина"] = "🥓",
        ["Рыба"] = "🐟",
        ["Морепродукты"] = "🦐",
        ["Икра"] = "🍣",
        ["Макароны"] = "🍝",
        ["Крупы, бобовые"] = "🌾",
        ["Хлопья, мюсли, каши"] = "🥣",
        ["Хлеб, лаваш, лепешки"] = "🍞",
        ["Круассаны, пироги, выпечка"] = "🥐",
        ["Вода питьевая, минеральная"] = "💧",
        ["Соки, нектары"] = "🧃",
        ["Газированные напитки"] = "🥤",
        ["Чай"] = "🍵",
        ["Растворимый кофе"] = "☕",
        ["Молотый, зерновой кофе"] = "☕",
        ["Печенье, пряники, вафли"] = "🍪",
        ["Конфеты"] = "🍬",
        ["Шоколад, батончики"] = "🍫",
        ["Торты, пирожные"] = "🎂",
        ["Мёд, варенье, сиропы"] = "🍯",
        ["Подсолнечное масло"] = "🌻",
        ["Оливковое, салатные масла"] = "🫒",
        ["Соусы, заправки"] = "🥫",
        ["Специи"] = "🌶️",
        ["Кетчуп, томатная паста"] = "🍅",
        ["Чипсы"] = "🍟",
        ["Корма для кошек"] = "🐱",
        ["Корма для собак"] = "🐶",
        ["Подгузники, пелёнки"] = "👶",
        ["Средства для стирки"] = "👕",
        ["Туалетная бумага"] = "🧻",
        ["Шампуни"] = "🧴",
        ["Зубные пасты, гели, порошки"] = "🦷",
    };

    public const string Default = "📦";

    public static string Get(string? categoryName)
    {
        if (string.IsNullOrEmpty(categoryName))
            return Default;

        return Map.GetValueOrDefault(categoryName, Default);
    }

    public static string Get(string? categoryName, string? parentCategoryName)
    {
        if (!string.IsNullOrEmpty(categoryName) && Map.TryGetValue(categoryName, out var emoji))
            return emoji;

        if (!string.IsNullOrEmpty(parentCategoryName) && Map.TryGetValue(parentCategoryName, out emoji))
            return emoji;

        return Default;
    }
}
```

---

## 2. ProductEmoji

Для товаров из магазина (ProductSearchResult.Name). Нечёткий поиск по ключевым словам.

```csharp
public static class ProductEmoji
{
    // Порядок важен! Специфичные ключевые слова — первыми
    private static readonly (string Keyword, string Emoji)[] Keywords =
    {
        // ═══ Молочка ═══
        ("сыр", "🧀"),
        ("творог", "🧀"),
        ("йогурт", "🥛"),
        ("кефир", "🥛"),
        ("ряженк", "🥛"),
        ("сметан", "🥛"),
        ("сливки", "🥛"),
        ("молок", "🥛"),
        ("масло сливочн", "🧈"),
        ("маргарин", "🧈"),
        ("яйц", "🥚"),
        ("мороженое", "🍦"),
        ("пломбир", "🍦"),

        // ═══ Мясо ═══
        ("курин", "🍗"),
        ("куриц", "🍗"),
        ("курица", "🍗"),
        ("цыпл", "🍗"),
        ("индейк", "🍗"),
        ("утка", "🍗"),
        ("говядин", "🥩"),
        ("свинин", "🥩"),
        ("баранин", "🥩"),
        ("телятин", "🥩"),
        ("фарш", "🥩"),
        ("стейк", "🥩"),
        ("мясо", "🥩"),
        ("шашлык", "🍖"),
        ("рёбр", "🍖"),
        ("ребр", "🍖"),

        // ═══ Колбасы ═══
        ("сосиск", "🌭"),
        ("сардельк", "🌭"),
        ("колбас", "🌭"),
        ("ветчин", "🥓"),
        ("бекон", "🥓"),
        ("грудинк", "🥓"),
        ("паштет", "🥫"),

        // ═══ Рыба ═══
        ("лосось", "🐟"),
        ("сёмга", "🐟"),
        ("семга", "🐟"),
        ("форель", "🐟"),
        ("треска", "🐟"),
        ("минтай", "🐟"),
        ("горбуш", "🐟"),
        ("скумбри", "🐟"),
        ("сельд", "🐟"),
        ("рыб", "🐟"),
        ("креветк", "🦐"),
        ("кальмар", "🦑"),
        ("краб", "🦀"),
        ("икра", "🍣"),

        // ═══ Овощи ═══
        ("картофель", "🥔"),
        ("картошк", "🥔"),
        ("морков", "🥕"),
        ("помидор", "🍅"),
        ("томат", "🍅"),
        ("огурц", "🥒"),
        ("капуст", "🥬"),
        ("брокколи", "🥦"),
        ("кабачок", "🥒"),
        ("баклажан", "🍆"),
        ("салат", "🥬"),
        ("зелень", "🥬"),
        ("укроп", "🌿"),
        ("петрушк", "🌿"),
        ("лук", "🧅"),
        ("чеснок", "🧄"),
        ("перец", "🌶️"),
        ("свёкл", "🥕"),
        ("свекл", "🥕"),
        ("тыкв", "🎃"),
        ("овощ", "🥕"),

        // ═══ Фрукты ═══
        ("яблок", "🍎"),
        ("банан", "🍌"),
        ("апельсин", "🍊"),
        ("мандарин", "🍊"),
        ("лимон", "🍋"),
        ("виноград", "🍇"),
        ("груш", "🍐"),
        ("персик", "🍑"),
        ("абрикос", "🍑"),
        ("слив", "🍑"),
        ("черешн", "🍒"),
        ("вишн", "🍒"),
        ("клубник", "🍓"),
        ("малин", "🍓"),
        ("ягод", "🍓"),
        ("арбуз", "🍉"),
        ("дын", "🍈"),
        ("ананас", "🍍"),
        ("киви", "🥝"),
        ("манго", "🥭"),
        ("авокадо", "🥑"),
        ("фрукт", "🍎"),

        // ═══ Грибы, орехи ═══
        ("шампиньон", "🍄"),
        ("гриб", "🍄"),
        ("орех", "🥜"),
        ("миндаль", "🥜"),
        ("фундук", "🥜"),
        ("кешью", "🥜"),
        ("фисташк", "🥜"),
        ("арахис", "🥜"),
        ("семечк", "🌻"),
        ("изюм", "🍇"),
        ("курага", "🍇"),
        ("чернослив", "🍇"),

        // ═══ Хлеб, выпечка ═══
        ("хлеб", "🍞"),
        ("батон", "🍞"),
        ("багет", "🥖"),
        ("лаваш", "🍞"),
        ("булк", "🍞"),
        ("круассан", "🥐"),
        ("пирог", "🥧"),
        ("пирожок", "🥧"),
        ("слойк", "🥐"),
        ("выпечк", "🥐"),
        ("печень", "🍪"),
        ("пряник", "🍪"),
        ("вафл", "🧇"),
        ("сушк", "🥨"),
        ("сухар", "🥨"),
        ("хлебц", "🥖"),

        // ═══ Крупы, макароны ═══
        ("макарон", "🍝"),
        ("спагетти", "🍝"),
        ("паста", "🍝"),
        ("лапша", "🍜"),
        ("рис", "🍚"),
        ("греч", "🌾"),
        ("овсян", "🥣"),
        ("геркулес", "🥣"),
        ("крупа", "🌾"),
        ("каша", "🥣"),
        ("мюсли", "🥣"),
        ("хлопья", "🥣"),
        ("мука", "🌾"),

        // ═══ Напитки ═══
        ("сок", "🧃"),
        ("нектар", "🧃"),
        ("морс", "🍹"),
        ("компот", "🍹"),
        ("вода", "💧"),
        ("газировк", "🥤"),
        ("кола", "🥤"),
        ("лимонад", "🥤"),
        ("энергетик", "⚡"),
        ("квас", "🍺"),

        // ═══ Чай, кофе ═══
        ("кофе", "☕"),
        ("капучино", "☕"),
        ("эспрессо", "☕"),
        ("латте", "☕"),
        ("чай", "🍵"),
        ("какао", "☕"),

        // ═══ Сладости ═══
        ("шоколад", "🍫"),
        ("конфет", "🍬"),
        ("карамель", "🍬"),
        ("леденец", "🍭"),
        ("торт", "🎂"),
        ("пирожн", "🧁"),
        ("кекс", "🧁"),
        ("мармелад", "🍡"),
        ("зефир", "🍡"),
        ("халв", "🍡"),
        ("мёд", "🍯"),
        ("мед", "🍯"),
        ("варень", "🍓"),
        ("джем", "🍓"),
        ("сгущён", "🥛"),
        ("сгущен", "🥛"),

        // ═══ Соусы, масла ═══
        ("масло подсолн", "🌻"),
        ("масло оливк", "🫒"),
        ("масло растит", "🌻"),
        ("оливков", "🫒"),
        ("кетчуп", "🍅"),
        ("томатн паст", "🍅"),
        ("соус", "🥫"),
        ("майонез", "🥫"),
        ("горчиц", "🌶️"),
        ("специ", "🌶️"),
        ("приправ", "🌶️"),
        ("соль", "🧂"),
        ("сахар", "🧂"),

        // ═══ Консервы ═══
        ("консерв", "🥫"),
        ("тушёнк", "🥫"),
        ("тушенк", "🥫"),
        ("горошек", "🥫"),
        ("кукуруз", "🌽"),
        ("фасоль", "🥫"),
        ("оливк", "🫒"),
        ("маслин", "🫒"),

        // ═══ Снеки ═══
        ("чипс", "🍟"),
        ("попкорн", "🍿"),
        ("крекер", "🥨"),
        ("снек", "🍿"),

        // ═══ Готовая еда ═══
        ("пельмен", "🥟"),
        ("вареник", "🥟"),
        ("хинкал", "🥟"),
        ("манты", "🥟"),
        ("пицц", "🍕"),
        ("суши", "🍣"),
        ("ролл", "🍣"),
        ("сэндвич", "🥪"),
        ("бургер", "🍔"),
        ("блин", "🥞"),
        ("оладь", "🥞"),
        ("сырник", "🥞"),

        // ═══ Заморозка ═══
        ("заморож", "🧊"),
        ("замороз", "🧊"),

        // ═══ Детское ═══
        ("детск", "👶"),
        ("малыш", "👶"),
        ("подгузник", "👶"),
        ("памперс", "👶"),

        // ═══ Животные ═══
        ("кошк", "🐱"),
        ("кошач", "🐱"),
        ("котов", "🐱"),
        ("собак", "🐶"),
        ("собач", "🐶"),
        ("корм", "🐾"),
        ("наполнител", "🐾"),

        // ═══ Бытовая химия ═══
        ("стирк", "👕"),
        ("порошок", "👕"),
        ("моющ", "🧴"),
        ("чистящ", "🧴"),
        ("мыло", "🧼"),
        ("шампун", "🧴"),
        ("гель для душ", "🚿"),
        ("зубн паст", "🦷"),
        ("зубная", "🦷"),
        ("щётк", "🪥"),
        ("щетк", "🪥"),
        ("туалетн бумаг", "🧻"),
        ("салфетк", "🧻"),
        ("губк", "🧽"),
    };

    public const string Default = "📦";

    public static string Get(string? productName)
    {
        if (string.IsNullOrEmpty(productName))
            return Default;

        var lower = productName.ToLowerInvariant();

        foreach (var (keyword, emoji) in Keywords)
        {
            if (lower.Contains(keyword))
                return emoji;
        }

        return Default;
    }
}
```

---

## Использование

```csharp
// Список покупок (правая панель) — по категории из справочника
var emoji = CategoryEmoji.Get(draftItem.Category);

// Карточка товара из магазина — по названию товара
var emoji = ProductEmoji.Get(product.Name);

// Примеры
ProductEmoji.Get("Шампиньоны Каждый День замороженные");  // 🍄
ProductEmoji.Get("Молоко 3.2% ультрапастеризованное");    // 🥛
ProductEmoji.Get("Сыр Российский 50%");                   // 🧀
ProductEmoji.Get("Что-то непонятное");                    // 📦
```

---

## Файлы

```
src/SmartBasket.Core/Utils/
├── CategoryEmoji.cs
└── ProductEmoji.cs
```

---

## Расширение

При добавлении новых категорий/товаров:

1. **CategoryEmoji** — добавить точное название категории в Map
2. **ProductEmoji** — добавить ключевое слово (корень слова) в Keywords

Порядок в Keywords важен — более специфичные слова должны идти раньше общих.
